{"version":3,"sources":["src/element.js","src/dom-utils.js","src/reconciler.js","src/component.js","src/didact.js","index.js"],"names":["createElement","TEXT_ELEMENT","type","config","props","Object","assign","args","hasChildren","length","rawChildren","concat","children","filter","c","map","createTextElement","value","nodeValue","updateDomProperties","dom","prevProps","nextProps","isEvent","name","startsWith","isAttribute","keys","forEach","eventType","toLowerCase","substring","removeEventListener","addEventListener","render","reconcile","rootInstance","element","container","prevInstance","nextInstance","parentDom","instance","newInstance","instantiate","appendChild","removeChild","replaceChild","childInstances","reconcileChildren","publicInstance","childElement","oldChildInstance","childInstance","nextChildElements","newChildInstances","count","Math","max","i","newChildInstance","push","isDomElement","isTextElement","document","createTextNode","childElements","childDoms","childDom","createPublicInstance","Component","state","partialState","updateInstance","__internalInstance","internalInstance","parentNode","LabeledSlider","onInput","App","e","setState","target","console","log","bind","getElementById"],"mappings":"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","file":"didactsource.451651ed.map","sourceRoot":"..","sourcesContent":["export const TEXT_ELEMENT = \"TEXT ELEMENT\";\n\nexport function createElement(type, config, ...args) {\n  const props = Object.assign({}, config);\n  const hasChildren = args.length > 0;\n  const rawChildren = hasChildren ? [].concat(...args) : [];\n  props.children = rawChildren\n    .filter(c => c != null && c !== false)\n    .map(c => c instanceof Object ? c : createTextElement(c));\n  return { type, props };\n}\n\nfunction createTextElement(value) {\n  return createElement(TEXT_ELEMENT, { nodeValue: value });\n}\n","export function updateDomProperties(dom, prevProps, nextProps) {\n  const isEvent = name => name.startsWith(\"on\");\n  const isAttribute = name => !isEvent(name) && name != \"children\";\n\n  // Remove event listeners\n  Object.keys(prevProps).filter(isEvent).forEach(name => {\n    const eventType = name.toLowerCase().substring(2);\n    dom.removeEventListener(eventType, prevProps[name]);\n  });\n\n  // Remove attributes\n  Object.keys(prevProps).filter(isAttribute).forEach(name => {\n    dom[name] = null;\n  });\n\n  // Set attributes\n  Object.keys(nextProps).filter(isAttribute).forEach(name => {\n    dom[name] = nextProps[name];\n  });\n\n  // Add event listeners\n  Object.keys(nextProps).filter(isEvent).forEach(name => {\n    const eventType = name.toLowerCase().substring(2);\n    dom.addEventListener(eventType, nextProps[name]);\n  });\n}\n","import { updateDomProperties } from \"./dom-utils\";\nimport { TEXT_ELEMENT } from \"./element\";\nimport { createPublicInstance } from \"./component\";\n\nlet rootInstance = null;\n\nexport function render(element, container) {\n  const prevInstance = rootInstance;\n  const nextInstance = reconcile(container, prevInstance, element);\n  rootInstance = nextInstance;\n}\n\nexport function reconcile(parentDom, instance, element) {\n  if (instance == null) {\n    // Create instance\n    const newInstance = instantiate(element);\n    parentDom.appendChild(newInstance.dom);\n    return newInstance;\n  } else if (element == null) {\n    // Remove instance\n    parentDom.removeChild(instance.dom);\n    return null;\n  } else if (instance.element.type !== element.type) {\n    // Replace instance\n    const newInstance = instantiate(element);\n    parentDom.replaceChild(newInstance.dom, instance.dom);\n    return newInstance;\n  } else if (typeof element.type === \"string\") {\n    // Update dom instance\n    updateDomProperties(instance.dom, instance.element.props, element.props);\n    instance.childInstances = reconcileChildren(instance, element);\n    instance.element = element;\n    return instance;\n  } else {\n    //Update composite instance\n    instance.publicInstance.props = element.props;\n    const childElement = instance.publicInstance.render();\n    const oldChildInstance = instance.childInstance;\n    const childInstance = reconcile(parentDom, oldChildInstance, childElement);\n    instance.dom = childInstance.dom;\n    instance.childInstance = childInstance;\n    instance.element = element;\n    return instance;\n  }\n}\n\nfunction reconcileChildren(instance, element) {\n  const dom = instance.dom;\n  const childInstances = instance.childInstances;\n  const nextChildElements = element.props.children || [];\n  const newChildInstances = [];\n  const count = Math.max(childInstances.length, nextChildElements.length);\n  for (let i = 0; i < count; i++) {\n    const childInstance = childInstances[i];\n    const childElement = nextChildElements[i];\n    const newChildInstance = reconcile(dom, childInstance, childElement);\n    newChildInstances.push(newChildInstance);\n  }\n  return newChildInstances.filter(instance => instance != null);\n}\n\nfunction instantiate(element) {\n  const { type, props } = element;\n  const isDomElement = typeof type === \"string\";\n\n  if (isDomElement) {\n    // Instantiate DOM element\n    const isTextElement = type === TEXT_ELEMENT;\n    const dom = isTextElement\n      ? document.createTextNode(\"\")\n      : document.createElement(type);\n\n    updateDomProperties(dom, [], props);\n\n    const childElements = props.children || [];\n    const childInstances = childElements.map(instantiate);\n    const childDoms = childInstances.map(childInstance => childInstance.dom);\n    childDoms.forEach(childDom => dom.appendChild(childDom));\n\n    const instance = { dom, element, childInstances };\n    return instance;\n  } else {\n    // Instantiate component element\n    const instance = {};\n    const publicInstance = createPublicInstance(element, instance);\n    const childElement = publicInstance.render();\n    const childInstance = instantiate(childElement);\n    const dom = childInstance.dom;\n\n    Object.assign(instance, { dom, element, childInstance, publicInstance });\n    return instance;\n  }\n}\n","import { reconcile } from \"./reconciler\";\n\nexport class Component {\n  constructor(props) {\n    this.props = props;\n    this.state = this.state || {};\n  }\n\n  setState(partialState) {\n    this.state = Object.assign({}, this.state, partialState);\n    updateInstance(this.__internalInstance);\n  }\n}\n\nfunction updateInstance(internalInstance) {\n  const parentDom = internalInstance.dom.parentNode;\n  const element = internalInstance.element;\n  reconcile(parentDom, internalInstance, element);\n}\n\nexport function createPublicInstance(element, internalInstance) {\n  const { type, props } = element;\n  const publicInstance = new type(props);\n  publicInstance.__internalInstance = internalInstance;\n  return publicInstance;\n}\n","import { createElement } from \"./element\";\nimport { Component } from \"./component\";\nimport { render } from \"./reconciler\";\n\nexport default {\n  createElement,\n  Component,\n  render\n};\n\nexport { createElement, Component, render };\n","/** @jsx createElement */\nimport { render, createElement, Component } from \"./src/didact\";\n\nclass LabeledSlider extends Component {\n  render() {\n    const {value, onInput} = this.props\n    return <input type=\"range\" onInput={onInput} min={20} max={80} value={value}/>\n  }\n}\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.state = { value: '40' };\n  }\n  onInput(e) {\n    this.setState({ value: e.target.value });\n  }\n  render() {\n    const {value} = this.state\n    console.log({value})\n    return (\n      <div>\n        <LabeledSlider onInput={this.onInput.bind(this)} value={value}/>\n        {value}\n      </div>\n    );\n  }\n}\n\nrender(<App />, document.getElementById(\"app\"));\n"]}